<?xml version="1.0" encoding="UTF-8"?>
<sequence>
  <block>
    <blocknum>B1</blocknum>
    <blockname>Initalize and configure the network analyzer Keysight E5071C</blockname>
    <step>
      <stepnum>1.1</stepnum>
      <stepname>Initialize Keysight network analyzer E5071C, and open the connection.</stepname>
      <stepdescription>Intialize Keysight E5071C, and open the connection over Ethernet cable. </stepdescription>
      <stepfieldenabled>false</stepfieldenabled>
      <stepfieldname>
      </stepfieldname>
      <functionname>InitializeNetworkAnalyzerE5071C</functionname>
      <parameterlist>
        <parameter>USB0::0x0957::0x0D09::MY46629634::0::INSTR</parameter>
      </parameterlist>
      <limittype>String</limittype>
      <spec>
        <limit>Agilent Technologies,E5071C,MY46629634,B.13.30</limit>
      </spec>
    </step>
    <step>
      <stepnum>1.2</stepnum>
      <stepname>Preset the window layout and display format.</stepname>
      <stepdescription>Clean up the window display of network analyzer.</stepdescription>
      <stepfieldenabled>false</stepfieldenabled>
      <stepfieldname>
      </stepfieldname>
      <functionname>PresetNetworkAnalyzerWindowLayoutDisplay</functionname>
      <parameterlist />
      <limittype>String</limittype>
      <spec>
        <limit>OK</limit>
      </spec>
    </step>
    <step>
      <stepnum>1.3</stepnum>
      <stepname>Configure the channel display mode</stepname>
      <stepdescription>Select the window layout for the network analyzer front panel.</stepdescription>
      <stepfieldenabled>false</stepfieldenabled>
      <stepfieldname>
      </stepfieldname>
      <functionname>ConfigWindowDisplayLayout</functionname>
      <parameterlist>
        <parameter>D1_2</parameter>
      </parameterlist>
      <limittype>String</limittype>
      <spec>
        <limit>OK</limit>
      </spec>
    </step>
    <step>
      <stepnum>1.4</stepnum>
      <stepname>Allocate 1 traces for channel 1.</stepname>
      <stepdescription>
      </stepdescription>
      <stepfieldenabled>false</stepfieldenabled>
      <stepfieldname>
      </stepfieldname>
      <functionname>AllocateTraceAmountForChannel</functionname>
      <parameterlist>
        <parameter>1</parameter>
        <parameter>1</parameter>
      </parameterlist>
      <limittype>String</limittype>
      <spec>
        <limit>OK</limit>
      </spec>
    </step>
    <step>
      <stepnum>1.5</stepnum>
      <stepname>Configure the trace graph layout for channel 1.</stepname>
      <stepdescription>Trace graph layout : D1</stepdescription>
      <stepfieldenabled>false</stepfieldenabled>
      <stepfieldname>
      </stepfieldname>
      <functionname>ConfigTraceDisplayModeInChannel</functionname>
      <parameterlist>
        <parameter>1</parameter>
        <parameter>D1</parameter>
      </parameterlist>
      <limittype>String</limittype>
      <spec>
        <limit>OK</limit>
      </spec>
    </step>
    <step>
      <stepnum>1.5.1</stepnum>
      <stepname>Setup the trace S-Parameter and data format for Channel1.Trace1</stepname>
      <stepdescription>S-Parameter : S22, Data format : MLOG</stepdescription>
      <stepfieldenabled>false</stepfieldenabled>
      <stepfieldname>
      </stepfieldname>
      <functionname>ConfigureMeasurementSParameterAndFormat</functionname>
      <parameterlist>
        <parameter>1</parameter>
        <parameter>1</parameter>
        <parameter>S22</parameter>
        <parameter>MLOG</parameter>
      </parameterlist>
      <limittype>String</limittype>
      <spec>
        <limit>OK</limit>
      </spec>
    </step>
    <step>
      <stepnum>1.6</stepnum>
      <stepname>Allocate 1 traces for channel 2.</stepname>
      <stepdescription>
      </stepdescription>
      <stepfieldenabled>false</stepfieldenabled>
      <stepfieldname>
      </stepfieldname>
      <functionname>AllocateTraceAmountForChannel</functionname>
      <parameterlist>
        <parameter>2</parameter>
        <parameter>1</parameter>
      </parameterlist>
      <limittype>String</limittype>
      <spec>
        <limit>OK</limit>
      </spec>
    </step>
    <step>
      <stepnum>1.7</stepnum>
      <stepname>Configure trace graph layout for channel 2.</stepname>
      <stepdescription>Trace display mode : D1</stepdescription>
      <stepfieldenabled>false</stepfieldenabled>
      <stepfieldname>
      </stepfieldname>
      <functionname>ConfigTraceDisplayModeInChannel</functionname>
      <parameterlist>
        <parameter>2</parameter>
        <parameter>D1</parameter>
      </parameterlist>
      <limittype>String</limittype>
      <spec>
        <limit>OK</limit>
      </spec>
    </step>
    <step>
      <stepnum>1.7.1</stepnum>
      <stepname>Setup the trace S-Parameter and data format for Channel2.Trace1</stepname>
      <stepdescription>S-Parameter : S33, Data format : SMITH</stepdescription>
      <stepfieldenabled>false</stepfieldenabled>
      <stepfieldname>
      </stepfieldname>
      <functionname>ConfigureMeasurementSParameterAndFormat</functionname>
      <parameterlist>
        <parameter>2</parameter>
        <parameter>1</parameter>
        <parameter>S22</parameter>
        <parameter>MLOG</parameter>
      </parameterlist>
      <limittype>String</limittype>
      <spec>
        <limit>OK</limit>
      </spec>
    </step>
    <step>
      <stepnum>1.8</stepnum>
      <stepname>Setup the sweep frequency range for Channel1.Trace1</stepname>
      <stepdescription>Start freq.: 500MHz, Stop freq.: 3GHz</stepdescription>
      <stepfieldenabled>false</stepfieldenabled>
      <stepfieldname>
      </stepfieldname>
      <functionname>ConfigSweepFreqRange</functionname>
      <parameterlist>
        <parameter>1</parameter>
        <parameter>500e6</parameter>
        <parameter>1.8e9</parameter>
      </parameterlist>
      <limittype>String</limittype>
      <spec>
        <limit>OK</limit>
      </spec>
    </step>
    <step>
      <stepnum>1.9</stepnum>
      <stepname>Configure the trace display scale for Channel1.Trace1</stepname>
      <stepdescription>
      </stepdescription>
      <stepfieldenabled>false</stepfieldenabled>
      <stepfieldname>
      </stepfieldname>
      <functionname>ConfigureChannelTraceDisplayScale</functionname>
      <parameterlist>
        <parameter>1</parameter>
        <parameter>1</parameter>
        <parameter>10</parameter>
        <parameter>2.0</parameter>
        <parameter>5</parameter>
        <parameter>-10</parameter>
      </parameterlist>
      <limittype>String</limittype>
      <spec>
        <limit>OK</limit>
      </spec>
    </step>
    <step>
      <stepnum>1.20</stepnum>
      <stepname>Max Channel1.Trace1 ON display</stepname>
      <stepdescription>
      </stepdescription>
      <stepfieldenabled>false</stepfieldenabled>
      <stepfieldname>
      </stepfieldname>
      <functionname>MaximizeOnOffChannelTraceDisplay</functionname>
      <parameterlist>
        <parameter>1</parameter>
        <parameter>ON</parameter>
        <parameter>1</parameter>
        <parameter>ON</parameter>
      </parameterlist>
      <limittype>String</limittype>
      <spec>
        <limit>OK</limit>
      </spec>
    </step>
    <step>
      <stepnum>1.21</stepnum>
      <stepname>Set up the sweep frequency range for channel2.Trace1</stepname>
      <stepdescription>Start freq: 1.8GHz, Stop freq.: 3GHz</stepdescription>
      <stepfieldenabled>false</stepfieldenabled>
      <stepfieldname>
      </stepfieldname>
      <functionname>ConfigSweepFreqRange</functionname>
      <parameterlist>
        <parameter>2</parameter>
        <parameter>1.8e9</parameter>
        <parameter>3e9</parameter>
      </parameterlist>
      <limittype>String</limittype>
      <spec>
        <limit>OK</limit>
      </spec>
    </step>
    <step>
      <stepnum>1.22</stepnum>
      <stepname>Configure the trace display scale for Channel2.Trace1</stepname>
      <stepdescription>
      </stepdescription>
      <stepfieldenabled>false</stepfieldenabled>
      <stepfieldname>
      </stepfieldname>
      <functionname>ConfigureChannelTraceDisplayScale</functionname>
      <parameterlist>
        <parameter>2</parameter>
        <parameter>1</parameter>
        <parameter>10</parameter>
        <parameter>2.0</parameter>
        <parameter>5</parameter>
        <parameter>-10</parameter>
      </parameterlist>
      <limittype>String</limittype>
      <spec>
        <limit>OK</limit>
      </spec>
    </step>
    <step>
      <stepnum>1.23</stepnum>
      <stepname>Change the channel display mode to D12</stepname>
      <stepdescription>
      </stepdescription>
      <stepfieldenabled>false</stepfieldenabled>
      <stepfieldname>
      </stepfieldname>
      <functionname>ConfigWindowDisplayLayout</functionname>
      <parameterlist>
        <parameter>D12</parameter>
      </parameterlist>
      <limittype>String</limittype>
      <spec>
        <limit>OK</limit>
      </spec>
    </step>
  </block>
  <block>
    <blocknum>B2</blocknum>
    <blockname>Set up the test limits and mask line</blockname>
  </block>
</sequence>