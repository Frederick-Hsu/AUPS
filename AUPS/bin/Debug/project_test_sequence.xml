<?xml version="1.0" encoding="utf-8"?>
<sequence>
  <block>
    <blocknum>B1</blocknum>
    <blockname>Initialization</blockname>
    <step>
      <stepnum>S1</stepnum>
      <stepname>Open COM port</stepname>
      <stepdescription>Open the COM port to initialize the network analyzer</stepdescription>
      <functionname>ProjectTestItem.OpenCom</functionname>
      <parameterlist>
        <parameter>COM:1</parameter>
        <parameter>BAUD:115200</parameter>
        <parameter>LEN:8</parameter>
        <parameter>STOP:1</parameter>
        <parameter>PARITY:none</parameter>
        <parameter>CRC:none</parameter>
      </parameterlist>
      <limittype>Numerical</limittype>
      <spec>
        <limit>12.5</limit>
        <limit>15</limit>
        <limit>17.5</limit>
      </spec>
    </step>
    <step>
      <stepnum>S2</stepnum>
      <stepname>Communicate with DMM</stepname>
      <stepdescription>Connect with DMM over the GPIB interface</stepdescription>
      <functionname>ProjectTestItem.ConnectDmm</functionname>
      <parameterlist>
        <parameter>PRIM:23</parameter>
        <parameter>SECN:15</parameter>
        <parameter>TIMEOUT:200</parameter>
        <parameter>
        </parameter>
      </parameterlist>
      <limittype>String</limittype>
      <spec>
        <limit>OK</limit>
      </spec>
    </step>
    <step>
      <stepnum>S3</stepnum>
      <stepname>Configure network</stepname>
      <stepdescription>Configure the ethernet for the distributed test stations</stepdescription>
      <functionname>ProjecttestItem.ConfigNetwork</functionname>
      <parameterlist>
        <parameter>IP:192.168.10.105</parameter>
        <parameter>PORT:3680</parameter>
        <parameter>SOCKET:UDP</parameter>
      </parameterlist>
      <limittype>String</limittype>
      <spec>
        <limit>OK</limit>
      </spec>
    </step>
  </block>
  <block>
    <blocknum>B2</blocknum>
    <blockname>Checking DUT status</blockname>
    <step>
      <stepnum>S4</stepnum>
      <stepname>Checking DUT power ON status</stepname>
      <stepdescription>Confirm that the DUT had been powered on.</stepdescription>
      <functionname>ProjTestItem.CheckPowerOn</functionname>
      <parameterlist>
        <parameter>Source:12V</parameter>
      </parameterlist>
      <limittype>Numerical</limittype>
      <spec>
        <limit>10</limit>
        <limit>12</limit>
        <limit>15</limit>
      </spec>
    </step>
  </block>
  <block>
    <blocknum>B3</blocknum>
    <blockname>Voltage measurement</blockname>
    <step>
      <stepnum>S5</stepnum>
      <stepname>Measure VDD</stepname>
      <stepdescription>Measure the voltage of power supply circuit : VDD</stepdescription>
      <functionname>ProjectTestItem.MeasureVdd</functionname>
      <parameterlist>
        <parameter>POS:TP503</parameter>
        <parameter>NEG:TP125</parameter>
      </parameterlist>
      <limittype>Numerical</limittype>
      <spec>
        <limit>3.0</limit>
        <limit>3.3</limit>
        <limit>3.6</limit>
      </spec>
    </step>
    <step>
      <stepnum>VOL10</stepnum>
      <stepname>Measure the Vref for ADC sampling channels.</stepname>
      <stepdescription>Make sure that the reference voltage is absolutely stable.</stepdescription>
      <functionname>ProjectTestItem.MeasureAdcVref</functionname>
      <parameterlist>
        <parameter>POS:Vref</parameter>
        <parameter>NEG:GND</parameter>
      </parameterlist>
      <limittype>Numerical</limittype>
      <spec>
        <limit>4.8</limit>
        <limit>5.0</limit>
        <limit>5.2</limit>
      </spec>
    </step>
  </block>
  <block>
    <blocknum>B4</blocknum>
    <blockname>RF calibration and validation</blockname>
    <step>
      <stepnum>S4.1</stepnum>
      <stepname>Network analyzer configuration</stepname>
      <stepdescription>Configure the Agilent network analyzer NA3692B.</stepdescription>
      <functionname>ProjectTestItem.CheckStatus</functionname>
      <parameterlist>
        <parameter>IP:192.168.10.13</parameter>
        <parameter>Port:1205</parameter>
        <parameter>Cleanup</parameter>
        <parameter>SmithDiagram</parameter>
        <parameter>BaudDiagram</parameter>
        <parameter>AttenuationPath</parameter>
      </parameterlist>
      <limittype>String</limittype>
      <spec>
        <limit>OK</limit>
      </spec>
    </step>
    <step>
      <stepnum>S10</stepnum>
      <stepname>Power meter configuration</stepname>
      <stepdescription>Configure the power meter (Agilent P73A2) and calibrate its base power.</stepdescription>
      <functionname>ProjectTestItem.CheckStatus</functionname>
      <parameterlist>
        <parameter>IP:192.168.10.13</parameter>
        <parameter>Port:1205</parameter>
        <parameter>Calibration</parameter>
        <parameter>CentralFreq:1900MHz</parameter>
        <parameter>BasePower:-30dBm</parameter>
      </parameterlist>
      <limittype>Numerical</limittype>
      <spec>
        <limit>-32.5</limit>
        <limit>-30</limit>
        <limit>-28.5</limit>
      </spec>
    </step>
  </block>
  <block>
    <blocknum>B5</blocknum>
    <blockname>RF frequency-response feature</blockname>
    <step>
      <stepnum>S7</stepnum>
      <stepname>Measure S11 impedance</stepname>
      <stepdescription>Measure the attenuation of RF shielding cable itself, i.e. S11 impedance (unit : dB)</stepdescription>
      <functionname>ProjectTestItem.MeasureS11</functionname>
      <parameterlist>
        <parameter>REF:-12.5dBm</parameter>
        <parameter>FREQ:2.4GHz</parameter>
      </parameterlist>
      <limittype>Numerical</limittype>
      <spec>
        <limit>20.5</limit>
        <limit>25.0</limit>
        <limit>28.5</limit>
      </spec>
    </step>
    <step>
      <stepnum>S8</stepnum>
      <stepname>Measure S12 Smith-Baud attenuation feature</stepname>
      <stepdescription>View the Smith-Baud diagram in the network analyzer, and acquire the attenuation path feature.</stepdescription>
      <functionname>ProjTestItem.MeasureS12Attenuation</functionname>
      <parameterlist>
        <parameter>FreqBand:Start:2.35GHz</parameter>
        <parameter>FreqBand:End:2.45GHz</parameter>
      </parameterlist>
      <limittype>Numerical</limittype>
      <spec>
        <limit>8dB</limit>
        <limit>10dB</limit>
        <limit>12dB</limit>
      </spec>
    </step>
  </block>
  <block>
    <blocknum>B20</blocknum>
    <blockname>Field testing</blockname>
    <step>
      <stepnum>RSSI-10</stepnum>
      <stepname>Measure the RSSI (i.e. receiver sensitivity) performance</stepname>
      <stepdescription>Check the sensitity index for antenna array.</stepdescription>
      <functionname>ProjTestItem.MeasureRssiPerformance</functionname>
      <parameterlist>
        <parameter>CentralFreq:2900MHz</parameter>
        <parameter>Span:2MHz</parameter>
        <parameter>Attenuation:10dB</parameter>
        <parameter>RefPower:-80dBm</parameter>
      </parameterlist>
      <limittype>Numerical</limittype>
      <spec>
        <limit>-65dBm</limit>
        <limit>-70dBm</limit>
        <limit>-75dBm</limit>
      </spec>
    </step>
    <step>
      <stepnum>SPwr10</stepnum>
      <stepname>Measure the max power</stepname>
      <stepdescription>Measure RF Tx power at the working freq.</stepdescription>
      <functionname>ProjTestItem.MeasurePower</functionname>
      <parameterlist>
        <parameter>CentralFreq:2900MHz</parameter>
        <parameter>Span:2MHz</parameter>
        <parameter>Deviation:0.5KHz</parameter>
        <parameter>Attenuation:10dB</parameter>
        <parameter>BasePower:-25dBm</parameter>
      </parameterlist>
      <limittype>Numerical</limittype>
      <spec>
        <limit>-35.5</limit>
        <limit>-37.5</limit>
        <limit>-39.5</limit>
      </spec>
    </step>
    <step>
      <stepnum>S2.2</stepnum>
      <stepname>Check the LED indicators' status</stepname>
      <stepdescription>Make sure DUT's 3 LEDs can work well, DUT starts to work after power on.</stepdescription>
      <functionname>ProjTestItem.CheckLED</functionname>
      <parameterlist>
        <parameter>PowerLED</parameter>
        <parameter>LinkLED</parameter>
        <parameter>DataLED</parameter>
      </parameterlist>
      <limittype>String</limittype>
      <spec>
        <limit>OK</limit>
      </spec>
    </step>
  </block>
  <block>
    <blocknum>B6</blocknum>
    <blockname>Instrument settings</blockname>
    <step>
      <stepnum>S8</stepnum>
      <stepname>Digitial multimeter configuration</stepname>
      <stepdescription>Setup the multimeter and configure its IP address</stepdescription>
      <functionname>ProjTestItem.ConfigureDmmIPAddress</functionname>
      <parameterlist>
        <parameter>IP:192.168.10.25</parameter>
        <parameter>PORT:2506</parameter>
      </parameterlist>
      <limittype>String</limittype>
      <spec>
        <limit>OK</limit>
      </spec>
    </step>
    <step>
      <stepnum>S9</stepnum>
      <stepname>Network analyzer settings</stepname>
      <stepdescription>Setup the network analyzer (Agilent A6530B)</stepdescription>
      <functionname>ProjtestItem.ConfigNetworkAnalyzer</functionname>
      <parameterlist>
        <parameter>IP:192.168.10.12</parameter>
        <parameter>Port:1024</parameter>
        <parameter>REF:-12.5dBm</parameter>
        <parameter>FREQ:2.4GHz</parameter>
      </parameterlist>
      <limittype>String</limittype>
      <spec>
        <limit>OK</limit>
      </spec>
    </step>
    <step>
      <stepnum>S10</stepnum>
      <stepname>Power meter configuration</stepname>
      <stepdescription>Configure the power meter (Agilent P73A2) and calibrate its base power.</stepdescription>
      <functionname>ProjectTestItem.CheckStatus</functionname>
      <parameterlist>
        <parameter>IP:192.168.10.13</parameter>
        <parameter>Port:1205</parameter>
        <parameter>Calibration</parameter>
        <parameter>CentralFreq:1900MHz</parameter>
        <parameter>BasePower:-30dBm</parameter>
      </parameterlist>
      <limittype>Numerical</limittype>
      <spec>
        <limit>-32.5</limit>
        <limit>-30</limit>
        <limit>-28.5</limit>
      </spec>
    </step>
    <step>
      <stepnum>S3</stepnum>
      <stepname>Configure network</stepname>
      <stepdescription>Configure the ethernet for the distributed test stations</stepdescription>
      <functionname>ProjecttestItem.ConfigNetwork</functionname>
      <parameterlist>
        <parameter>IP:192.168.10.105</parameter>
        <parameter>PORT:3680</parameter>
        <parameter>SOCKET:UDP</parameter>
      </parameterlist>
      <limittype>String</limittype>
      <spec>
        <limit>OK</limit>
      </spec>
    </step>
    <step>
      <stepnum>SP10</stepnum>
      <stepname>Measure the peak power for remote key</stepname>
      <stepdescription>RF transmitting power at 433MHz</stepdescription>
      <functionname>ProjTestitem.MeasureTxPower</functionname>
      <parameterlist>
        <parameter>Freq:2.4GHz</parameter>
        <parameter>Attenuation:10dB</parameter>
        <parameter>Span:160KHz</parameter>
        <parameter>BasePower:-25dBm</parameter>
      </parameterlist>
      <limittype>String</limittype>
      <spec>
        <limit>Peak power is out of spec.</limit>
      </spec>
    </step>
  </block>
</sequence>